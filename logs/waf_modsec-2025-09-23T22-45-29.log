2025-09-23T22:43:54.165382834Z /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
2025-09-23T22:43:54.165420076Z /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
2025-09-23T22:43:54.166656985Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/01-check-low-port.sh
2025-09-23T22:43:54.168741159Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-generate-certificate.sh
2025-09-23T22:43:54.170604753Z /usr/local/bin/generate-certificate: generating new certificate
2025-09-23T22:43:54.192133564Z Warning: Not placing -key in cert or request since request is used
2025-09-23T22:43:54.195191373Z Warning: No -copy_extensions given; ignoring any extensions in the request
2025-09-23T22:43:54.197193944Z /usr/local/bin/generate-certificate: generated /etc/nginx/conf/server.key and /etc/nginx/conf/server.crt
2025-09-23T22:43:54.197546591Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
2025-09-23T22:43:54.200666964Z 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
2025-09-23T22:43:54.213030278Z 10-listen-on-ipv6-by-default.sh: info: /etc/nginx/conf.d/default.conf differs from the packaged version
2025-09-23T22:43:54.213249416Z /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
2025-09-23T22:43:54.213409636Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
2025-09-23T22:43:54.218944832Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/modsecurity.d/modsecurity.conf.template to /etc/nginx/modsecurity.d/modsecurity.conf
2025-09-23T22:43:54.221640449Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/modsecurity.d/modsecurity-override.conf.template to /etc/nginx/modsecurity.d/modsecurity-override.conf
2025-09-23T22:43:54.224110111Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/modsecurity.d/setup.conf.template to /etc/nginx/modsecurity.d/setup.conf
2025-09-23T22:43:54.226602225Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/conf.d/default.conf.template to /etc/nginx/conf.d/default.conf
2025-09-23T22:43:54.229924883Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/conf.d/logging.conf.template to /etc/nginx/conf.d/logging.conf
2025-09-23T22:43:54.235417737Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/conf.d/modsecurity.conf.template to /etc/nginx/conf.d/modsecurity.conf
2025-09-23T22:43:54.239104021Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/includes/cors.conf.template to /etc/nginx/includes/cors.conf
2025-09-23T22:43:54.242027570Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/includes/location_common.conf.template to /etc/nginx/includes/location_common.conf
2025-09-23T22:43:54.244440163Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/includes/proxy_backend.conf.template to /etc/nginx/includes/proxy_backend.conf
2025-09-23T22:43:54.246699793Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/includes/proxy_backend_ssl.conf.template to /etc/nginx/includes/proxy_backend_ssl.conf
2025-09-23T22:43:54.252069551Z 20-envsubst-on-templates.sh: Running envsubst on /etc/nginx/templates/nginx.conf.template to /etc/nginx/nginx.conf
2025-09-23T22:43:54.255281951Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
2025-09-23T22:43:54.257175341Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/90-copy-modsecurity-config.sh
2025-09-23T22:43:54.262637228Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/91-update-resolver.sh
2025-09-23T22:43:54.276255078Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/92-update-real_ip.sh
2025-09-23T22:43:54.280666765Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/93-update-proxy-ssl-config.sh
2025-09-23T22:43:54.283179049Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/94-activate-plugins.sh
2025-09-23T22:43:54.284298500Z # # #
2025-09-23T22:43:54.284331195Z Running CRS plugin activation
2025-09-23T22:43:54.284341632Z - - -
2025-09-23T22:43:54.284348451Z 
2025-09-23T22:43:54.292078310Z - - -
2025-09-23T22:43:54.292099166Z Finished CRS plugin activation
2025-09-23T22:43:54.292104052Z # # #
2025-09-23T22:43:54.292108301Z 
2025-09-23T22:43:54.292439460Z /docker-entrypoint.sh: Launching /docker-entrypoint.d/95-configure-rules.sh
2025-09-23T22:43:54.292931372Z # # #
2025-09-23T22:43:54.292951117Z Running CRS rule configuration
2025-09-23T22:43:54.292959813Z - - -
2025-09-23T22:43:54.296036097Z Detected CRS config file version: v4
2025-09-23T22:43:54.327068114Z Configuring 900000 for BLOCKING_PARANOIA with blocking_paranoia_level=1
2025-09-23T22:43:54.378778403Z Configuring 900001 for DETECTION_PARANOIA with detection_paranoia_level=1
2025-09-23T22:43:54.404645376Z Configuring 900110 for ANOMALY_INBOUND with inbound_anomaly_score_threshold=5
2025-09-23T22:43:54.421568009Z Configuring 900110 for ANOMALY_OUTBOUND with outbound_anomaly_score_threshold=4
2025-09-23T22:43:54.550738590Z - - -
2025-09-23T22:43:54.550763987Z Finished CRS rule configuration
2025-09-23T22:43:54.550772964Z # # #
2025-09-23T22:43:54.550779622Z 
2025-09-23T22:43:54.550984234Z /docker-entrypoint.sh: Ignoring /docker-entrypoint.d/configure-rules.v3.conf
2025-09-23T22:43:54.551057660Z /docker-entrypoint.sh: Ignoring /docker-entrypoint.d/configure-rules.v4.conf
2025-09-23T22:43:54.551272795Z /docker-entrypoint.sh: Configuration complete; ready for start up
2025-09-23T22:43:54.841766600Z 2025/09/23 22:43:54 [warn] 1#1: "ssl_stapling" ignored, issuer certificate not found for certificate "/etc/nginx/conf/server.crt"
2025-09-23T22:43:54.841793209Z nginx: [warn] "ssl_stapling" ignored, issuer certificate not found for certificate "/etc/nginx/conf/server.crt"
2025-09-23T22:43:54.841895359Z 2025/09/23 22:43:54 [notice] 1#1: ModSecurity-nginx v1.0.4 (rules loaded inline/local/remote: 0/836/0)
2025-09-23T22:43:54.841926170Z 2025/09/23 22:43:54 [notice] 1#1: libmodsecurity3 version 3.0.14
2025-09-23T22:44:53.545948559Z 2025/09/23 22:44:53 [error] 593#593: *2 [client 192.168.35.11] ModSecurity: Access denied with code 403 (phase 2). Matched "Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file "/etc/modsecurity.d/owasp-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf"] [line "222"] [id "949110"] [rev ""] [msg "Inbound Anomaly Score Exceeded (Total Score: 5)"] [data ""] [severity "0"] [ver "OWASP_CRS/4.18.0"] [maturity "0"] [accuracy "0"] [tag "modsecurity"] [tag "anomaly-evaluation"] [tag "OWASP_CRS"] [hostname "dvwa"] [uri "/vulnerabilities/sqli/"] [unique_id "175866749384.150114"] [ref ""], client: 192.168.35.11, server: localhost, request: "GET /vulnerabilities/sqli/?id=1'+OR+'1'='1'--+-&Submit=Submit HTTP/1.1", host: "dvwa"
2025-09-23T22:44:53.546670661Z 192.168.35.11 - - [23/Sep/2025:22:44:53 +0000] "GET /vulnerabilities/sqli/?id=1'+OR+'1'='1'--+-&Submit=Submit HTTP/1.1" 403 146 "-" "curl/8.15.0" "-"
2025-09-23T22:44:53.547081088Z {"transaction":{"client_ip":"192.168.35.11","time_stamp":"Tue Sep 23 22:44:53 2025","server_id":"87fd30665edb2132505191dc705de484043d2765","client_port":37024,"host_ip":"192.168.35.30","host_port":8080,"unique_id":"175866749384.150114","request":{"method":"GET","http_version":1.1,"uri":"/vulnerabilities/sqli/?id=1'+OR+'1'='1'--+-&Submit=Submit","headers":{"Host":"dvwa","User-Agent":"curl/8.15.0","Cookie":"PHPSESSID=test; security=low","Accept":"*/*"}},"response":{"body":"<html>\r\n<head><title>403 Forbidden</title></head>\r\n<body>\r\n<center><h1>403 Forbidden</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n","http_code":403,"headers":{"Server":"nginx","Date":"Tue, 23 Sep 2025 22:44:53 GMT","Content-Length":"146","Content-Type":"text/plain","Access-Control-Allow-Origin":"*","Connection":"keep-alive","Access-Control-Max-Age":"3600","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"*"}},"producer":{"modsecurity":"ModSecurity v3.0.14 (Linux)","connector":"ModSecurity-nginx v1.0.4","secrules_engine":"Enabled","components":["OWASP_CRS/4.18.0\""]},"messages":[{"message":"SQL Injection Attack Detected via libinjection","details":{"match":"detected SQLi using libinjection.","reference":"v30,17","ruleId":"942100","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf","lineNumber":"46","data":"Matched Data: s&sos found within ARGS:id: 1' OR '1'='1'-- -","severity":"2","ver":"OWASP_CRS/4.18.0","rev":"","tags":["application-multi","language-multi","platform-multi","attack-sqli","paranoia-level/1","OWASP_CRS","OWASP_CRS/ATTACK-SQLI","capec/1000/152/248/66"],"maturity":"0","accuracy":"0"}},{"message":"Inbound Anomaly Score Exceeded (Total Score: 5)","details":{"match":"Matched \"Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' )","reference":"","ruleId":"949110","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf","lineNumber":"222","data":"","severity":"0","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","anomaly-evaluation","OWASP_CRS"],"maturity":"0","accuracy":"0"}}]}}
2025-09-23T22:45:15.113303602Z 2025/09/23 22:45:15 [error] 594#594: *4 [client 192.168.35.11] ModSecurity: Access denied with code 403 (phase 2). Matched "Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `20' ) [file "/etc/modsecurity.d/owasp-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf"] [line "222"] [id "949110"] [rev ""] [msg "Inbound Anomaly Score Exceeded (Total Score: 20)"] [data ""] [severity "0"] [ver "OWASP_CRS/4.18.0"] [maturity "0"] [accuracy "0"] [tag "modsecurity"] [tag "anomaly-evaluation"] [tag "OWASP_CRS"] [hostname "dvwa"] [uri "/vulnerabilities/xss_r/"] [unique_id "175866751538.990453"] [ref ""], client: 192.168.35.11, server: localhost, request: "GET /vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E HTTP/1.1", host: "dvwa"
2025-09-23T22:45:15.114287075Z 192.168.35.11 - - [23/Sep/2025:22:45:15 +0000] "GET /vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E HTTP/1.1" 403 146 "-" "curl/8.15.0" "-"
2025-09-23T22:45:15.114693757Z {"transaction":{"client_ip":"192.168.35.11","time_stamp":"Tue Sep 23 22:45:15 2025","server_id":"87fd30665edb2132505191dc705de484043d2765","client_port":59210,"host_ip":"192.168.35.30","host_port":8080,"unique_id":"175866751538.990453","request":{"method":"GET","http_version":1.1,"uri":"/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E","headers":{"Host":"dvwa","User-Agent":"curl/8.15.0","Cookie":"security=low","Accept":"*/*"}},"response":{"body":"<html>\r\n<head><title>403 Forbidden</title></head>\r\n<body>\r\n<center><h1>403 Forbidden</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n","http_code":403,"headers":{"Server":"nginx","Date":"Tue, 23 Sep 2025 22:45:15 GMT","Content-Length":"146","Content-Type":"text/plain","Access-Control-Allow-Origin":"*","Connection":"keep-alive","Access-Control-Max-Age":"3600","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"*"}},"producer":{"modsecurity":"ModSecurity v3.0.14 (Linux)","connector":"ModSecurity-nginx v1.0.4","secrules_engine":"Enabled","components":["OWASP_CRS/4.18.0\""]},"messages":[{"message":"XSS Attack Detected via libinjection","details":{"match":"detected XSS using libinjection.","reference":"v33,29t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls","ruleId":"941100","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf","lineNumber":"83","data":"Matched Data: XSS data found within ARGS:name: <script>alert(\"XSS\")</script>","severity":"2","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","application-multi","language-multi","platform-multi","attack-xss","xss-perf-disable","paranoia-level/1","OWASP_CRS","OWASP_CRS/ATTACK-XSS","capec/1000/152/242"],"maturity":"0","accuracy":"0"}},{"message":"XSS Filter - Category 1: Script Tag Vector","details":{"match":"Matched \"Operator `Rx' with parameter `(?i)<script[^>]*>[\\s\\S]*?' against variable `ARGS:name' (Value: `<script>alert(\"XSS\")</script>' )","reference":"o0,8v33,29t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls","ruleId":"941110","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf","lineNumber":"110","data":"Matched Data: <script> found within ARGS:name: <script>alert(\"XSS\")</script>","severity":"2","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","application-multi","language-multi","platform-multi","attack-xss","xss-perf-disable","paranoia-level/1","OWASP_CRS","OWASP_CRS/ATTACK-XSS","capec/1000/152/242"],"maturity":"0","accuracy":"0"}},{"message":"NoScript XSS InjectionChecker: HTML Injection","details":{"match":"Matched \"Operator `Rx' with parameter `(?i)<[^0-9<>A-Z_a-z]*(?:[^\\s\\x0b\\\"'<>]*:)?[^0-9<>A-Z_a-z]*[^0-9A-Z_a-z]*?(?:s[^0-9A-Z_a-z]*?(?:c[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?t|t[^0-9A-Z_a-z]*?y[^0-9A-Z_a-z]*?l[^0-9A (4396 characters omitted)' against variable `ARGS:name' (Value: `<script>alert(\"XSS\")</script>' )","reference":"o0,7v33,29t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls","ruleId":"941160","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf","lineNumber":"205","data":"Matched Data: <script found within ARGS:name: <script>alert(\"XSS\")</script>","severity":"2","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","application-multi","language-multi","platform-multi","attack-xss","xss-perf-disable","paranoia-level/1","OWASP_CRS","OWASP_CRS/ATTACK-XSS","capec/1000/152/242"],"maturity":"0","accuracy":"0"}},{"message":"Javascript method detected","details":{"match":"Matched \"Operator `Rx' with parameter `(?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\x0b]+Function|a(?:lert|tob)|btoa|(?:promp|impor)t|con(?:firm|sole\\.(?:log|dir))|fetch)[\\s\\x0b]*[\\(\\{]' against variable `ARGS:name' (Value: `<script>alert(\"XSS\")</script>' )","reference":"o8,6v33,29t:htmlEntityDecode,t:jsDecode","ruleId":"941390","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf","lineNumber":"739","data":"Matched Data: alert( found within ARGS:name: <script>alert(\"XSS\")</script>","severity":"2","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","application-multi","language-multi","platform-nodejs","attack-xss","xss-perf-disable","paranoia-level/1","OWASP_CRS","OWASP_CRS/ATTACK-XSS","capec/1000/152/242"],"maturity":"0","accuracy":"0"}},{"message":"Inbound Anomaly Score Exceeded (Total Score: 20)","details":{"match":"Matched \"Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `20' )","reference":"","ruleId":"949110","file":"/etc/modsecurity.d/owasp-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf","lineNumber":"222","data":"","severity":"0","ver":"OWASP_CRS/4.18.0","rev":"","tags":["modsecurity","anomaly-evaluation","OWASP_CRS"],"maturity":"0","accuracy":"0"}}]}}
